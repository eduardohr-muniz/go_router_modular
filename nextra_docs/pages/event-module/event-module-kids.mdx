# ğŸ­ EventModule: Like a Magic Telephone Central! 

Imagine that EventModule is like a **magic telephone central** in your city! ğŸ“âœ¨

## ğŸ  What is an EventModule?

Think of EventModule as **different houses** in your city. Each house (module) can:
- ğŸ‘‚ **Listen** to special phone calls
- ğŸ“¢ **Send** messages to other houses
- ğŸ”” **Receive** important notifications

```dart
class LoginEventModule extends EventModule {
  @override
  void listen() {
    // This house listens when someone logs in! ğŸ‘‹
    on<LoginEvent>((event, context) {
      print('ğŸ‰ Welcome, ${event.username}!');
      if (context != null) {
        context.go('/home'); // Go to home page
      }
    });
  }
}
```

## ğŸ“ How Does the Telephone Central Work?

### 1. ğŸ“¢ Sending Messages (Firing Events)

When something important happens, you "shout" to the whole city:

```dart
// ğŸ—£ï¸ "HEY EVERYONE! John just logged in!"
ModularEvent.fire(LoginEvent(username: 'John'));

// ğŸ—£ï¸ "ATTENTION! A new message arrived!"
ModularEvent.fire(NotificationEvent(message: 'You have a gift!'));

// ğŸ—£ï¸ "WATCH OUT! Something went wrong!"
ModularEvent.fire(ErrorEvent(error: 'Slow internet'));
```

### 2. ğŸ‘‚ Listening to Messages (Listening Events)

Each house can choose which types of "shouts" it wants to listen to:

```dart
class NotificationModule extends EventModule {
  @override
  void listen() {
    // ğŸ”” This house listens to notifications
    on<NotificationEvent>((event, context) {
      showDialog(
        context: context!,
        builder: (context) => AlertDialog(
          title: Text('ğŸ“¬ New Message!'),
          content: Text(event.message),
        ),
      );
    });

    // âŒ This house also listens to errors
    on<ErrorEvent>((event, context) {
      ScaffoldMessenger.of(context!).showSnackBar(
        SnackBar(
          content: Text('ğŸ’¥ Oops! ${event.error}'),
          backgroundColor: Colors.red,
        ),
      );
    });
  }
}
```

## ğŸµ The Exclusive System: Like a Special Radio

Imagine you have a **very special radio** that can only play one song at a time! ğŸµ

### ğŸ“» Normal Mode (Non-Exclusive)
```dart
// ğŸ¶ ALL houses listen to the same song at the same time
on<MusicEvent>((event, context) {
  print('ğŸµ Playing: ${event.songName}');
}); // exclusive: false (default)
```

**What happens:**
- John's House: ğŸµ "Playing: Happy Birthday"
- Maria's House: ğŸµ "Playing: Happy Birthday"  
- Peter's House: ğŸµ "Playing: Happy Birthday"

### ğŸ“» Exclusive Mode (Radio Queue)
```dart
// ğŸ¯ Only ONE house can listen at a time!
on<MusicEvent>((event, context) {
  print('ğŸµ Only I listen: ${event.songName}');
}, exclusive: true);
```

**What happens:**
1. ğŸ  **John's House** enters queue first â†’ ğŸµ He listens to the song
2. ğŸ  **Maria's House** enters queue â†’ â³ Waits
3. ğŸ  **Peter's House** enters queue â†’ â³ Waits

```
ğŸ“‹ RADIO QUEUE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸµ John (playing now)   â”‚ â† Active
â”‚ â³ Maria (waiting)       â”‚ â† Next
â”‚ â³ Peter (waiting)       â”‚ â† After
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸƒâ€â™‚ï¸ When Someone Leaves the Queue

If John leaves home (dispose), the radio **automatically** goes to Maria:

```
ğŸ“‹ AFTER JOHN LEAVES:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸµ Maria (playing now)  â”‚ â† Now active!
â”‚ â³ Peter (waiting)       â”‚ â† Next
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸª Real World Examples

### ğŸ” Login System
```dart
class LoginModule extends EventModule {
  @override
  void listen() {
    // When someone logs in
    on<LoginEvent>((event, context) {
      print('ğŸ‘‹ Hello, ${event.username}!');
      // Go to main screen
      context?.go('/dashboard');
    });

    // When someone logs out  
    on<LogoutEvent>((event, context) {
      print('ğŸ‘‹ Bye, ${event.username}!');
      // Go back to login screen
      context?.go('/login');
    });
  }
}

// How to use:
ModularEvent.fire(LoginEvent(username: 'Ana'));
ModularEvent.fire(LogoutEvent(username: 'Ana'));
```

### ğŸ›’ Shopping Cart
```dart
class ShoppingModule extends EventModule {
  @override
  void listen() {
    // When adding product
    on<AddToCartEvent>((event, context) {
      print('ğŸ›’ Added: ${event.productName}');
      ScaffoldMessenger.of(context!).showSnackBar(
        SnackBar(content: Text('âœ… ${event.productName} in cart!'))
      );
    });

    // When finishing purchase
    on<PurchaseEvent>((event, context) {
      print('ğŸ’³ Purchase of \$${event.total} completed!');
      context?.go('/success');
    });
  }
}

// How to use:
ModularEvent.fire(AddToCartEvent(productName: 'Bicycle', price: 500.0));
ModularEvent.fire(PurchaseEvent(total: 500.0));
```

### ğŸ® Game System
```dart
class GameModule extends EventModule {
  @override
  void listen() {
    // Score system (exclusive - only one counter)
    on<ScoreEvent>((event, context) {
      print('ğŸ† New score: ${event.points}');
      updateScoreboard(event.points);
    }, exclusive: true);

    // Sound effects (normal - everyone listens)
    on<SoundEvent>((event, context) {
      print('ğŸ”Š Sound: ${event.soundName}');
      playSound(event.soundName);
    });
  }
}

// How to use:
ModularEvent.fire(ScoreEvent(points: 1000));
ModularEvent.fire(SoundEvent(soundName: 'coin.wav'));
```

## ğŸ¯ Important Rules

### 1. ğŸ  Automatic Cleanup
When a house is demolished (`dispose()`), it **automatically**:
- ğŸ§¹ Stops listening to all events
- ğŸ—‘ï¸ Cleans all memory
- ğŸ“» If it was on exclusive radio, passes to the next

### 2. ğŸŒ Magic Context
The `context` is like a **magic GPS** that shows you where you are:
```dart
on<NavigationEvent>((event, context) {
  if (context != null) {
    // ğŸ—ºï¸ You know where you are! Can navigate
    context.go('/new-page');
  } else {
    // ğŸ¤·â€â™‚ï¸ You don't know where you are... 
    print('Oops! I don't know where I am');
  }
});
```

### 3. ğŸ”„ AutoDispose
```dart
// ğŸ”’ This listener goes away when the house is demolished
on<MyEvent>((event, context) {
  // do something...
}, autoDispose: true); // default

// ğŸ”“ This listener stays forever (careful!)
on<MyEvent>((event, context) {
  // do something...
}, autoDispose: false); // dangerous!
```

## ğŸ¨ Creating Your Own Events

```dart
// ğŸ‚ Birthday event
class BirthdayEvent {
  final String personName;
  final int age;
  
  BirthdayEvent({required this.personName, required this.age});
}

// ğŸŒŸ Module that listens to birthdays
class BirthdayModule extends EventModule {
  @override
  void listen() {
    on<BirthdayEvent>((event, context) {
      print('ğŸ‰ Happy Birthday ${event.personName}! ${event.age} years old!');
      
      if (context != null) {
        showDialog(
          context: context,
          builder: (context) => AlertDialog(
            title: Text('ğŸ‚ Birthday!'),
            content: Text('${event.personName} is ${event.age} years old!'),
            actions: [
              TextButton(
                onPressed: () => Navigator.of(context).pop(),
                child: Text('ğŸ Cool!'),
              ),
            ],
          ),
        );
      }
    });
  }
}

// How to use:
ModularEvent.fire(BirthdayEvent(personName: 'Maria', age: 10));
```

## ğŸš€ Golden Tips

### âœ¨ Best Practices
```dart
// âœ… GOOD: Always check context
on<NavigationEvent>((event, context) {
  if (context != null) {
    context.go(event.route);
  }
});

// âœ… GOOD: Clear names for events
class UserLoginSuccessEvent { ... }
class ShoppingCartUpdatedEvent { ... }
class GameOverEvent { ... }

// âŒ BAD: Don't check context
on<NavigationEvent>((event, context) {
  context!.go(event.route); // Can cause error!
});
```

### ğŸª Complete Example: Shop App
```dart
// ğŸ“± Complete app with events
class ShopApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return GoRouterModularApp(
      title: 'ğŸ›ï¸ My Shop',
      modules: [
        LoginModule(),      // Handles login
        ShoppingModule(),   // Handles shopping  
        NotificationModule(), // Handles notifications
      ],
    );
  }
}

// ğŸª Shop module
class ShoppingModule extends EventModule {
  @override
  List<ModularRoute> get routes => [
    ChildRoute('/shop', child: (context, state) => ShopPage()),
    ChildRoute('/cart', child: (context, state) => CartPage()),
  ];

  @override
  void listen() {
    // When adding to cart
    on<AddToCartEvent>((event, context) {
      print('ğŸ›’ ${event.productName} added!');
      
      // Show notification
      ModularEvent.fire(NotificationEvent(
        message: '${event.productName} in your cart!'
      ));
    });

    // When removing from cart
    on<RemoveFromCartEvent>((event, context) {
      print('ğŸ—‘ï¸ ${event.productName} removed!');
    });

    // When finishing purchase (exclusive - only one at a time)
    on<CheckoutEvent>((event, context) {
      print('ğŸ’³ Processing purchase...');
      // Go to success page
      context?.go('/success');
    }, exclusive: true);
  }
}
```

## ğŸŠ Conclusion

EventModule is like a **magic city** where:
- ğŸ  **Houses** (modules) can listen to events
- ğŸ“¢ **Shouts** (events) spread information
- ğŸ“ **Telephone central** (EventBus) connects everything
- ğŸ“» **Exclusive radio** ensures order in queues
- ğŸ§¹ **Automatic cleanup** prevents mess

**Now you can create your own events and make your app talk like a happy city!** ğŸ™ï¸âœ¨

---

*"With great power comes great responsibility... always dispose your modules!"* ğŸ•·ï¸